var chess=document.getElementById("chess");var context=chess.getContext("2d");context.strokeStyle="#4d3128";var img=new Image();img.src="bg.png";img.onload=function(){context.drawImage(img,0,0,600,600,0,0,600,600);drawChess()};function drawChess(){for(var i=0;i<19;i++){context.moveTo(30+i*30,30);context.lineTo(30+i*30,570);context.stroke();context.moveTo(30,30+i*30);context.lineTo(570,30+i*30);context.stroke()}}var chessArry=[];for(var i=0;i<19;i++){chessArry[i]=[];for(var j=0;j<19;j++){chessArry[i][j]=0}}var wins=[];var count=0;function winMethod(){for(var i=0;i<19;i++){wins[i]=[];for(var j=0;j<19;j++){wins[i][j]=[]}}for(var i=0;i<19;i++){for(var j=0;j<15;j++){for(var r=0;r<5;r++){wins[i][j+r][count]=true}count++}}for(var i=0;i<19;i++){for(var j=0;j<15;j++){for(var r=0;r<5;r++){wins[j+r][i][count]=true}count++}}for(var i=0;i<15;i++){for(var j=0;j<15;j++){for(var r=0;r<5;r++){wins[i+r][j+r][count]=true}count++}}for(var i=0;i<15;i++){for(var j=18;j>3;j--){for(var r=0;r<5;r++){wins[i+r][j-r][count]=true}count++}}}winMethod();var myWin=[];var computerWin=[];for(var i=0;i<count;i++){myWin[i]=0;computerWin[i]=0}var myWin=[];var computerWin=[];for(var i=0;i<count;i++){myWin[i]=0;computerWin[i]=0}function chessStyle(x,y,bool){context.beginPath();context.arc(30+30*x,30+30*y,15,0,2*Math.PI);context.closePath();var gradient=context.createRadialGradient(30+x*30+2,30+y*30-2,15,30+x*30+2,30+y*30-2,0);if(bool){gradient.addColorStop(0,"#0a0a0a");gradient.addColorStop(1,"#636766")}else{gradient.addColorStop(0,"#d1d1d1");gradient.addColorStop(1,"#f9f9f9")}context.fillStyle=gradient;context.fill()}var flag=true;var over=true;chess.onclick=function(e){if(!over){tipBox("游戏结束",false);return}var x=Math.floor((e.offsetX-15)/30);var y=Math.floor((e.offsetY-15)/30);if(chessArry[x][y]==0){chessStyle(x,y,true);chessArry[x][y]=1;for(var i=0;i<count;i++){if(wins[x][y][i]){myWin[i]++;computerWin[i]==6;if(myWin[i]==5){tipBox("您赢了",false);break}}}}else{tipBox("此处已不能下棋子",true);return}computerWalk()};function tipBox(inner,isShow){var wrap=document.createElement("div");wrap.className="boxTip";wrap.innerHTML=inner;document.body.appendChild(wrap);if(isShow){setTimeout(function(){document.body.removeChild(wrap)},1200)}}function computerWalk(){var max=0;var u=0,v=0;var myScore=[];var computerScore=[];for(var i=0;i<15;i++){myScore[i]=[];computerScore[i]=[];for(var j=0;j<15;j++){myScore[i][j]=0;computerScore[i][j]=0}}for(var i=0;i<15;i++){for(var j=0;j<15;j++){if(chessArry[i][j]==0){for(var k=0;k<count;k++){if(wins[i][j][k]){if(myWin[k]==1){myScore[i][j]+=200}else{if(myWin[k]==2){myScore[i][j]+=400}else{if(myWin[k]==3){myScore[i][j]+=2000}else{if(myWin[k]==4){myScore[i][j]+=10000}}}}if(computerWin[k]==1){computerScore[i][j]+=220}else{if(computerWin[k]==2){computerScore[i][j]+=420}else{if(computerWin[k]==3){computerScore[i][j]+=2200}else{if(computerWin[k]==4){computerScore[i][j]+=20000}}}}}}if(myScore[i][j]>max){max=myScore[i][j];u=i;v=j}else{if(myScore[i][j]==max){if(computerScore[i][j]>computerScore[u][v]){u=i;v=j}}}if(computerScore[i][j]>max){max=computerScore[i][j];u=i;v=j}else{if(computerScore[i][j]==max){if(myScore[i][j]>myScore[u][v]){u=i;v=j}}}}}}chessStyle(u,v,false);chessArry[u][v]=2;flag=!flag;for(var k=0;k<count;k++){if(wins[u][v][k]){computerWin[k]++;myWin[k]=6;if(computerWin[k]==5){tipBox("计算机赢了",false);over=false}}}};